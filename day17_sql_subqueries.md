# SQL Practice – Day 17: Revisiting Subqueries

Today, I worked on writing and understanding subqueries in SQL — mostly focused on comparisons with single-row and multi-row subqueries. Below are the challenges and the corresponding queries (with answers using SCOTT schema).

---

## SCOTT Schema Setup

```sql
-- DEPT table
CREATE TABLE DEPT (
  DEPTNO NUMBER(2),
  DNAME VARCHAR2(14),
  LOC VARCHAR2(13)
);

INSERT INTO DEPT VALUES (10, 'ACCOUNTING', 'NEW YORK');
INSERT INTO DEPT VALUES (20, 'RESEARCH', 'DALLAS');
INSERT INTO DEPT VALUES (30, 'SALES', 'CHICAGO');
INSERT INTO DEPT VALUES (40, 'OPERATIONS', 'BOSTON');

-- EMP table
CREATE TABLE EMP (
  EMPNO NUMBER(4),
  ENAME VARCHAR2(10),
  JOB VARCHAR2(9),
  MGR NUMBER(4),
  HIREDATE DATE,
  SAL NUMBER(7,2),
  COMM NUMBER(7,2),
  DEPTNO NUMBER(2)
);

INSERT INTO EMP VALUES (7839, 'KING', 'PRESIDENT', NULL, TO_DATE('1981-11-17', 'YYYY-MM-DD'), 5000, NULL, 10);
INSERT INTO EMP VALUES (7566, 'JONES', 'MANAGER', 7839, TO_DATE('1981-04-02', 'YYYY-MM-DD'), 2975, NULL, 20);
INSERT INTO EMP VALUES (7698, 'BLAKE', 'MANAGER', 7839, TO_DATE('1981-05-01', 'YYYY-MM-DD'), 2850, NULL, 30);
INSERT INTO EMP VALUES (7782, 'CLARK', 'MANAGER', 7839, TO_DATE('1981-06-09', 'YYYY-MM-DD'), 2450, NULL, 10);
INSERT INTO EMP VALUES (7788, 'SCOTT', 'ANALYST', 7566, TO_DATE('1982-12-09', 'YYYY-MM-DD'), 3000, NULL, 20);
INSERT INTO EMP VALUES (7902, 'FORD', 'ANALYST', 7566, TO_DATE('1981-12-03', 'YYYY-MM-DD'), 3000, NULL, 20);
INSERT INTO EMP VALUES (7844, 'TURNER', 'SALESMAN', 7698, TO_DATE('1981-06-04', 'YYYY-MM-DD'), 1500, 0, 30);
INSERT INTO EMP VALUES (7900, 'JAMES', 'CLERK', 7698, TO_DATE('1981-12-03', 'YYYY-MM-DD'), 950, NULL, 30);
INSERT INTO EMP VALUES (7654, 'MARTIN', 'SALESMAN', 7698, TO_DATE('1981-09-28', 'YYYY-MM-DD'), 1250, 1400, 30);
INSERT INTO EMP VALUES (7499, 'ALLEN', 'SALESMAN', 7698, TO_DATE('1981-02-20', 'YYYY-MM-DD'), 1600, 300, 30);
INSERT INTO EMP VALUES (7521, 'WARD', 'SALESMAN', 7698, TO_DATE('1981-02-22', 'YYYY-MM-DD'), 1250, 500, 30);
INSERT INTO EMP VALUES (7934, 'MILLER', 'CLERK', 7782, TO_DATE('1982-01-23', 'YYYY-MM-DD'), 1300, NULL, 10);
INSERT INTO EMP VALUES (7876, 'ADAMS', 'CLERK', 7788, TO_DATE('1983-01-12', 'YYYY-MM-DD'), 1100, NULL, 20);
INSERT INTO EMP VALUES (7369, 'SMITH', 'CLERK', 7902, TO_DATE('1980-12-17', 'YYYY-MM-DD'), 800, NULL, 20);
```

---

## Queries and Answers

### 1. Employees earning more than ADAMS

```sql
SELECT ENAME FROM EMP
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'ADAMS');
```

**Result:** ALLEN, BLAKE, CLARK, FORD, JONES, KING, MARTIN, SCOTT, TURNER, WARD

### 2. Employees earning less than KING

```sql
SELECT ENAME, SAL FROM EMP
WHERE SAL < (SELECT SAL FROM EMP WHERE ENAME = 'KING');
```

**Result:** All employees except KING

### 3. Same department as JONES

```sql
SELECT ENAME, DEPTNO FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'JONES');
```

**Result:** JONES, FORD, SCOTT, ADAMS, SMITH

### 4. Same job as JAMES

```sql
SELECT ENAME, JOB FROM EMP
WHERE JOB = (SELECT JOB FROM EMP WHERE ENAME = 'JAMES');
```

**Result:** JAMES, SMITH, ADAMS, MILLER

### 5. Annual salary greater than WARD's

```sql
SELECT EMPNO, ENAME, SAL*12 AS ANNUAL_SAL FROM EMP
WHERE SAL*12 > (SELECT SAL*12 FROM EMP WHERE ENAME = 'WARD');
```

**Result:** ALLEN, BLAKE, CLARK, FORD, JONES, KING, MARTIN, SCOTT, TURNER

### 6. Hired before SCOTT

```sql
SELECT ENAME, HIREDATE FROM EMP
WHERE HIREDATE < (SELECT HIREDATE FROM EMP WHERE ENAME = 'SCOTT');
```

**Result:** Most employees except ADAMS, SCOTT, MILLER

### 7. Hired after the PRESIDENT

```sql
SELECT ENAME, HIREDATE FROM EMP
WHERE HIREDATE > (SELECT HIREDATE FROM EMP WHERE JOB = 'PRESIDENT');
```

**Result:** JAMES, FORD, SCOTT, ADAMS, MILLER

### 8. Earning less than EMPNO 7839

```sql
SELECT ENAME, SAL FROM EMP
WHERE SAL < (SELECT SAL FROM EMP WHERE EMPNO = 7839);
```

**Result:** All except KING

### 9. Hired before MILLER

```sql
SELECT * FROM EMP
WHERE HIREDATE < (SELECT HIREDATE FROM EMP WHERE ENAME = 'MILLER');
```

**Result:** Most employees

### 10. Earning more than ALLEN

```sql
SELECT ENAME, EMPNO FROM EMP
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'ALLEN');
```

**Result:** BLAKE, CLARK, FORD, JONES, KING, SCOTT

### 11. Salary between MILLER and ALLEN

```sql
SELECT ENAME, SAL FROM EMP
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'MILLER')
AND SAL < (SELECT SAL FROM EMP WHERE ENAME = 'ALLEN');
```

**Result:** WARD, MARTIN

### 12. DEPT 20 and same job as SMITH

```sql
SELECT * FROM EMP
WHERE DEPTNO = 20
AND JOB = (SELECT JOB FROM EMP WHERE ENAME = 'SMITH');
```

**Result:** ADAMS

### 13. Managers in TURNER's dept

```sql
SELECT * FROM EMP
WHERE JOB = 'MANAGER'
AND DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'TURNER');
```

**Result:** BLAKE

### 14. Hired after 1980 and before KING

```sql
SELECT ENAME, HIREDATE FROM EMP
WHERE HIREDATE > TO_DATE('1980-01-01','YYYY-MM-DD')
AND HIREDATE < (SELECT HIREDATE FROM EMP WHERE ENAME = 'KING');
```

**Result:** ALLEN, WARD, BLAKE, MARTIN, TURNER, CLARK, JONES

### 15. Salary < BLAKE and > 3500

```sql
SELECT ENAME, SAL, SAL*12 AS ANNUAL_SAL FROM EMP
WHERE SAL < (SELECT SAL FROM EMP WHERE ENAME = 'BLAKE')
AND SAL > 3500;
```

**Result:** CLARK

### 16. More than SCOTT, less than KING

```sql
SELECT * FROM EMP
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'SCOTT')
AND SAL < (SELECT SAL FROM EMP WHERE ENAME = 'KING');
```

**Result:** NONE

### 17. Name starts with 'A' in BLAKE's dept

```sql
SELECT ENAME FROM EMP
WHERE ENAME LIKE 'A%'
AND DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'BLAKE');
```

**Result:** ALLEN

### 18. Earn commission and same job as SMITH

```sql
SELECT ENAME, COMM FROM EMP
WHERE COMM IS NOT NULL
AND JOB = (SELECT JOB FROM EMP WHERE ENAME = 'SMITH');
```

**Result:** NONE

### 19. Clerks in TURNER's dept

```sql
SELECT * FROM EMP
WHERE JOB = 'CLERK'
AND DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'TURNER');
```

**Result:** JAMES

### 20. Annual salary > SMITH and < KING

```sql
SELECT ENAME, SAL, JOB FROM EMP
WHERE SAL*12 > (SELECT SAL*12 FROM EMP WHERE ENAME = 'SMITH')
AND SAL*12 < (SELECT SAL*12 FROM EMP WHERE ENAME = 'KING');
```

**Result:** Everyone except SMITH and KING

```

---

That wraps up Day 17. 

